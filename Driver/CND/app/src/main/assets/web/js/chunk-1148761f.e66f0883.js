(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1148761f"],{2366:function(t,e){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);function a(t,e){var i=e||0,a=n;return[a[t[i++]],a[t[i++]],a[t[i++]],a[t[i++]],"-",a[t[i++]],a[t[i++]],"-",a[t[i++]],a[t[i++]],"-",a[t[i++]],a[t[i++]],"-",a[t[i++]],a[t[i++]],a[t[i++]],a[t[i++]],a[t[i++]],a[t[i++]]].join("")}t.exports=a},"6aef":function(t,e,n){"use strict";var i=n("c4f4"),a=n.n(i);a.a},c0ff:function(t,e,n){},c437:function(t,e,n){var i,a,s=n("e1f4"),r=n("2366"),c=0,o=0;function u(t,e,n){var u=e&&n||0,l=e||[];t=t||{};var d=t.node||i,p=void 0!==t.clockseq?t.clockseq:a;if(null==d||null==p){var v=s();null==d&&(d=i=[1|v[0],v[1],v[2],v[3],v[4],v[5]]),null==p&&(p=a=16383&(v[6]<<8|v[7]))}var f=void 0!==t.msecs?t.msecs:(new Date).getTime(),m=void 0!==t.nsecs?t.nsecs:o+1,h=f-c+(m-o)/1e4;if(h<0&&void 0===t.clockseq&&(p=p+1&16383),(h<0||f>c)&&void 0===t.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=f,o=m,a=p,f+=122192928e5;var y=(1e4*(268435455&f)+m)%4294967296;l[u++]=y>>>24&255,l[u++]=y>>>16&255,l[u++]=y>>>8&255,l[u++]=255&y;var b=f/4294967296*1e4&268435455;l[u++]=b>>>8&255,l[u++]=255&b,l[u++]=b>>>24&15|16,l[u++]=b>>>16&255,l[u++]=p>>>8|128,l[u++]=255&p;for(var x=0;x<6;++x)l[u+x]=d[x];return e||r(l)}t.exports=u},c4f4:function(t,e,n){},c5e4:function(t,e,n){"use strict";var i=n("c0ff"),a=n.n(i);a.a},e1f4:function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var a=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0===(3&e)&&(t=4294967296*Math.random()),a[e]=t>>>((3&e)<<3)&255;return a}}},e68f:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{position:"relative"}},[t.ifTip?n("div",{staticClass:"block"},[t.ifTip?n("div",{staticClass:"tips"},[n("img",{staticClass:"close",attrs:{src:"/static/img/close.png"},on:{click:function(e){return t.closeTip()}}}),n("div",{staticClass:"tipsTitle"},[n("img",{staticClass:"info",attrs:{src:"/static/img/info.png"}}),n("p",{staticClass:"tipsTitleP"},[t._v(t._s(t.exName))])]),n("div",{staticClass:"tipP"},[t._v("\n                "+t._s(t.exReason)+"\n            ")]),n("div",{staticClass:"tipsYes",on:{click:function(e){return t.closeTip()}}},[t._v("\n                确定\n            ")])]):t._e()]):t._e(),n("div",{staticClass:"container"},[n("div",{staticClass:"inStockTitle"},[n("img",{staticClass:"back",attrs:{src:"/static/img/back.png"},on:{click:function(e){return t.back()}}}),n("p",{staticClass:"headP"},[t._v("请将出库疫苗扫码")]),n("img",{staticClass:"vaccineIn",attrs:{src:"/static/img/outCabineSetp1.png"}})]),n("div",{staticClass:"main"},[t._m(0),n("div",{staticClass:"table"},t._l(t.tableDatas,(function(e,i){return n("div",{staticClass:"tableData",class:{clicked:t.clickIndex==i}},[n("div",{staticClass:"index"},[i>8?n("span",[t._v(t._s(i+1))]):t._e(),i<8||8==i?n("span",[t._v("0"+t._s(i+1))]):t._e()]),n("div",{staticClass:"vaccineName"},[t._v("\n                        "+t._s(e.name)+"\n                    ")]),n("div",{staticClass:"code"},[t._v("\n                        "+t._s(e.batchNo)+"\n                    ")]),n("div",{staticClass:"code2"},[t._v("\n                        "+t._s(e.expiry)+"\n                    ")]),n("div",{staticClass:"coordinate"},[t._v("\n                        "+t._s("异常"==e.invalid?"异常":"正常")+"\n                    ")]),n("div",{staticClass:"count"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.count,expression:"item.count"}],staticClass:"countInput",attrs:{type:"text",readonly:"readonly"},domProps:{value:e.count},on:{input:function(n){n.target.composing||t.$set(e,"count",n.target.value)}}})])])})),0),n("div",{staticClass:"button"},[n("div",{staticClass:"finish",on:{click:function(e){return t.finish()}}},[t._v("\n                    出库完成\n                ")])])])])])},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title"},[n("div",{staticClass:"index"},[t._v("\n                    序号\n                ")]),n("div",{staticClass:"vaccineName"},[t._v("\n                    疫苗名称\n                ")]),n("div",{staticClass:"code"},[t._v("\n                    批次号\n                ")]),n("div",{staticClass:"code2"},[t._v("\n                    有效期\n                ")]),n("div",{staticClass:"coordinate"},[t._v("\n                    是否失效\n                ")]),n("div",{staticClass:"count"},[t._v("\n                    出库数量\n                ")])])}],s=(n("8e6e"),n("ac6a"),n("456d"),n("7f7f"),n("96cf"),n("3b8d")),r=n("bd86"),c=n("2f62"),o=n("c437"),u=n.n(o),l=n("c1df"),d=n.n(l);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(n,!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={data:function(){return{tableDatas:[],clickIndex:0,ifTip:!1,commonData:null,batchId:"",exName:"",exReason:""}},computed:v({},Object(c["c"])({user:"user",device:"device"})),components:{},methods:{back:function(){this.$router.push("/main")},closeTip:function(){this.ifTip=!1},queryVaccineByCondition:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$api.get("/vaccine/queryVaccineByCondition",e);case 2:return n=t.sent,t.abrupt("return",n.data[0]);case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),removeVaccineById:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$api.post("/vaccine/removeVaccineById",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),modifyVaccineNum:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$api.post("/vaccine/modifyVaccineNum",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),saveInout:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$api.post("/inout/saveInout",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),queryExceptionVaccine:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$api.get("/zcy/queryExceptionVaccine");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),scanOut:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={code:"ym991",name:"卡介苗",batchNo:"B-20191001",expiry:d()("2019-12-24").format("YYYY-MM-DD HH:mm:ss"),product:"上海生物制药有限公司"},t.next=3,this.queryVaccineByCondition({device:this.device._id,code:e.code});case 3:if(n=t.sent,console.log(n),!_.isEmpty(n)){t.next=7;break}return t.abrupt("return",!1);case 7:if(n.surplus-1!=0){t.next=12;break}return t.next=10,this.removeVaccineById({id:n._id});case 10:t.next=14;break;case 12:return t.next=14,this.modifyVaccineNum({id:n._id,total:0,surplus:-1});case 14:return t.next=16,this.saveInout(v({batchId:this.batchId},this.commonData,{code:e.code,name:e.name,total:n.total,surplus:n.surplus-1,product:n.product,use:1}));case 16:return n.invalid="正常",d()().isAfter(n.expiry)&&(this.exName=e.name,this.exReason="疫苗过期",n.invalid="异常",this.ifTip=!0),t.next=20,this.queryExceptionVaccine();case 20:return i=t.sent,e.batchNo==i.batchNo&&(this.exName=e.name,this.exReason="报废或失效",n.invalid="异常",this.ifTip=!0),t.next=24,this.freshTableDatas(n);case 24:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),freshTableDatas:function(t){var e=this.tableDatas,n=!0;if(_.isEmpty(e))t.count=1,t.clickIndex=0,e.push(t);else{for(var i=0;i<e.length;i++){if(t.code==e[i].code){e[i].count=parseInt(e[i].count)+1,e[i].clickIndex=i,n=!1;break}e[i].clickIndex=null}n&&(t.count=1,t.clickIndex=0,e.unshift(t))}},finish:function(){this.$router.push({path:"/inout/outStockEnd",query:{datas:this.tableDatas}})}},mounted:function(){this.scanOut(),this.batchId=u()(),this.commonData={type:2,user:this.user._id,device:this.device._id,deviceType:2,unitCode:this.device.unitCode,unitName:this.device.unitName}}},m=f,h=(n("c5e4"),n("6aef"),n("2877")),y=Object(h["a"])(m,i,a,!1,null,"1298a465",null);e["default"]=y.exports}}]);