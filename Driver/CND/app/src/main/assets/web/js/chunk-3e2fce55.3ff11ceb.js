(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e2fce55"],{"06fa":function(e,t,r){"use strict";var n=r("9825"),i=r.n(n);i.a},1338:function(e,t,r){},"177b":function(e,t,r){"use strict";var n=r("ba0e"),i=r.n(n);i.a},"5ed7":function(e,t,r){"use strict";var n=r("1338"),i=r.n(n);i.a},"7a7d":function(e,t,r){},9825:function(e,t,r){},ba0e:function(e,t,r){},e0df:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Row",[r("Col",{attrs:{span:"24"}},[r("Tabs",{attrs:{animated:!1}},[r("TabPane",{attrs:{label:"设置"}},[r("basic")],1),r("TabPane",{attrs:{label:"指纹录入"}},[e.fingerType?r("finger",{on:{add:e.addhandle}}):r("fingerEntry",{on:{save:e.savehandle}})],1)],1)],1)],1)},i=[],s=(r("8e6e"),r("ac6a"),r("456d"),r("bd86")),a=r("2f62"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"basic"},[r("Form",{ref:"frmEdit",attrs:{model:e.formBasic,rules:e.ruleValidate}},[r("Row",{staticClass:"bs-row",attrs:{type:"flex",gutter:8,align:"middle"}},[r("Col",{attrs:{span:"4",justify:"end"}},[r("p",{staticClass:"bs-title"},[e._v("\n                所在区域\n            ")])]),r("Col",{attrs:{span:"6",push:"1"}},[r("FormItem",{attrs:{prop:"address.provinceCode"}},[r("Select",{attrs:{"label-in-value":!0},on:{"on-change":e.changeProvince},model:{value:e.formBasic.address.provinceCode,callback:function(t){e.$set(e.formBasic.address,"provinceCode",t)},expression:"formBasic.address.provinceCode"}},e._l(e.provinces,(function(t){return r("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1)],1),r("Col",{attrs:{span:"6",push:"1"}},[r("FormItem",{attrs:{prop:"address.cityCode"}},[r("Select",{attrs:{"label-in-value":!0},on:{"on-change":e.changeCity},model:{value:e.formBasic.address.cityCode,callback:function(t){e.$set(e.formBasic.address,"cityCode",t)},expression:"formBasic.address.cityCode"}},e._l(e.citys,(function(t){return r("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1)],1),r("Col",{attrs:{span:"6",push:"1"}},[r("FormItem",{attrs:{prop:"address.countyCode"}},[r("Select",{attrs:{"label-in-value":!0},on:{"on-change":e.changeCounty},model:{value:e.formBasic.address.countyCode,callback:function(t){e.$set(e.formBasic.address,"countyCode",t)},expression:"formBasic.address.countyCode"}},e._l(e.countys,(function(t){return r("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1)],1)],1),r("Row",{staticClass:"bs-row",attrs:{align:"middle",type:"flex"}},[r("Col",{attrs:{span:"4",justify:"end"}},[r("p",{staticClass:"bs-title"},[e._v("\n                所在单位\n            ")])]),r("Col",{attrs:{span:"18",push:"1"}},[r("FormItem",{attrs:{prop:"unitCode"}},[r("Select",{attrs:{"label-in-value":!0},on:{"on-change":e.changeUnit},model:{value:e.formBasic.unitCode,callback:function(t){e.$set(e.formBasic,"unitCode",t)},expression:"formBasic.unitCode"}},e._l(e.units,(function(t){return r("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1)],1)],1),r("Row",{staticClass:"bs-row",attrs:{align:"middle",type:"flex"}},[r("Col",{attrs:{span:"4",justify:"end"}},[r("p",{staticClass:"bs-title"},[e._v("\n                设备编号\n            ")])]),r("Col",{attrs:{span:"18",push:"1"}},[r("FormItem",{attrs:{prop:"alias"}},[r("Input",{attrs:{size:"large",placeholder:"设备编号"},model:{value:e.formBasic.alias,callback:function(t){e.$set(e.formBasic,"alias",t)},expression:"formBasic.alias"}})],1)],1)],1),r("Row",{attrs:{type:"flex",justify:"center"}},[r("p",{staticClass:"bs-info"},[e._v("更改基本信息后请点击保存按钮")])]),r("Row",{staticClass:"bs-submit",attrs:{type:"flex",justify:"center"}},[r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.save("frmEdit")}}},[e._v("保存")])],1)],1)],1)},o=[],u=(r("7f7f"),r("96cf"),r("3b8d"));function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(r,!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f={data:function(){return{provinces:[],citys:[],countys:[],cabinetNos:[],units:[],formBasic:{alias:"",address:{provinceCode:"",provinceName:"",cityCode:"",cityName:"",countyCode:"",countyName:""},cabinetNo:"",unitCode:"",unitName:""},ruleValidate:{alias:[{required:!0,message:"请输入设备编号",trigger:"blur"}],cabinetNo:[{required:!0,type:"string",message:"请选择接种台编号",trigger:"change"}],unitCode:[{required:!0,type:"string",message:"请选择所在单位",trigger:"change"}],"address.provinceCode":[{required:!0,type:"string",message:"请选择省份",trigger:"change"}],"address.cityCode":[{required:!0,type:"string",message:"请选择市",trigger:"change"}],"address.countyCode":[{required:!0,type:"string",message:"请选择区(县)",trigger:"change"}]}}},computed:l({},Object(a["c"])({device:"device"})),methods:{init:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.device.address&&(this.formBasic.alias=this.device.alias,this.formBasic.cabinetNo=this.device.cabinetNo,this.formBasic.unitCode=this.device.unitCode,this.formBasic.unitName=this.device.unitName,this.formBasic.address.provinceCode=this.device.address.provinceCode,this.formBasic.address.cityCode=this.device.address.cityCode,this.formBasic.address.countyCode=this.device.address.countyCode,this.formBasic.address.provinceName=this.device.address.provinceName,this.formBasic.address.cityName=this.device.address.cityName,this.formBasic.address.countyName=this.device.address.countyName),e.next=3,this.queryDistrict();case 3:return e.next=5,this.queryCabinetNo();case 5:return e.next=7,this.queryUnit();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),queryUnit:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/zcy/queryUnit");case 2:t=e.sent,this.units=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),queryDistrict:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/zcy/queryDistrict");case 2:t=e.sent,t=t.data,this.provinces.push({name:t.name,code:t.code}),this.citys=t.child,this.countys=t.child[0].child;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),queryCabinetNo:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/zcy/queryCabinetNo");case 2:t=e.sent,this.cabinetNos=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),changeProvince:function(e){this.formBasic.address.provinceName=e.label},changeCity:function(e){this.formBasic.address.cityName=e.label},changeCounty:function(e){this.formBasic.address.countyName=e.label},changeUnit:function(e){this.formBasic.unitName=e.label},save:function(e){var t=this;this.$refs[e].validate((function(e){e&&t.$api.post("/device/modifyDevice",l({id:t.device._id},t.formBasic)).then((function(e){t.$Message.success("修改设备归属成功!")}))}))}},mounted:function(){this.init()}},p=f,m=(r("06fa"),r("2877")),v=Object(m["a"])(p,c,o,!1,null,null,null),h=v.exports,g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"fingerprint card"},[2==e.fingerCount?r("div",{staticClass:"fingerprint-info"},[e._v("指纹信息已采集")]):e._e(),e.fingerCount<2?r("div",{staticClass:"fingerprint-add",on:{click:function(t){return e.addFinger()}}},[e._v("新增")]):e._e(),r("div",{staticClass:"fingerprint-clear",on:{click:function(t){e.modal1=!0}}},[e._v("清除")]),r("Modal",{attrs:{title:"消息提示"},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[r("p",[e._v("是否确认删除所有指纹")])])],1)},y=[];function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(r,!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C={data:function(){return{modal1:!1,fingerCount:0}},computed:O({},Object(a["c"])({user:"user",device:"device"})),methods:O({},Object(a["b"])({saveUser:"saveUser"}),{ok:function(){this.delAll()},cancel:function(){this.modal1=!1},addFinger:function(){this.$emit("add",!1)},delAll:function(){var e=this;console.log("删除指纹前获取的user信息 result:"+JSON.stringify(this.user)),this.$device.fingerDelAll({userId:this.user._id}).then((function(t){0==JSON.parse(t.rsp).code&&(console.log("这里已经监听到删除的动作了"),e.deleteFinger({id:e.user._id,finger:[]}))}))},deleteFinger:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.post("/user/modifyUserById",t);case 2:r=e.sent,console.log("这里已经监听到更新指纹的动作了 result:"+JSON.stringify(r)),1==r.data.ok&&(this.user.finger=[],this.fingerCount=this.user.finger.length);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}),mounted:function(){this.fingerCount=this.user.finger.length}},j=C,w=(r("177b"),Object(m["a"])(j,g,y,!1,null,null,null)),_=w.exports,B=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"fingerAdd"},[e._m(0),r("div",{staticClass:"fingerAdd-footer"},[e.noticeState?e._e():r("div",{staticClass:"fingerAdd-notice"},[e._v(e._s(e.notice))]),e.noticeState?r("div",{staticClass:"fingerAdd-succeed"},[r("img",{attrs:{src:"/static/img/succeed.png",alt:""}}),r("div",[e._v("指纹录入成功，请保存")])]):e._e()])])},P=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"fingerAdd-conent"},[r("div",{staticClass:"fingerAdd-title"},[e._v("放置手指")]),r("div",{staticClass:"fingerAdd-info"},[e._v("将手指放置在指纹仪上，识别完成后移开，并重复此步骤")]),r("img",{attrs:{src:"/static/img/fingerEntry.png",alt:""}})])}];function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(r,!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var k={data:function(){return{noticeState:!1,notice:""}},computed:N({},Object(a["c"])({user:"user"})),methods:N({},Object(a["b"])({saveUser:"saveUser",saveDevice:"saveDevice"}),{register:function(){this.$device.fingerRegister({userId:this.user._id})},modifyUserById:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.post("/user/modifyUserById",t);case 2:e.sent;case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}),mounted:function(){var e=this;this.$device.subscribe("FINGER_MESSAGE",(function(t){if(e.notice=t.msg,2==t.type){e.noticeState=!0;var r=e.user.finger;if(r.push("2"),e.modifyUserById({id:e.user._id,finger:r}),r.length<2)e.register();else var n=setTimeout((function(){e.$emit("save",!0),clearTimeout(n)}),1500)}else e.noticeState=!1})),this.register()}},D=k,$=(r("f48e"),Object(m["a"])(D,B,P,!1,null,"42e2b4d4",null)),S=$.exports;function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(r,!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var q={components:{basic:h,finger:_,fingerEntry:S},data:function(){return{fingerType:!0}},computed:R({},Object(a["c"])({user:"user",device:"device"})),methods:{addhandle:function(e){this.fingerType=e},savehandle:function(e){this.fingerType=e}},mounted:function(){}},I=q,U=(r("5ed7"),Object(m["a"])(I,n,i,!1,null,null,null));t["default"]=U.exports},f48e:function(e,t,r){"use strict";var n=r("7a7d"),i=r.n(n);i.a}}]);