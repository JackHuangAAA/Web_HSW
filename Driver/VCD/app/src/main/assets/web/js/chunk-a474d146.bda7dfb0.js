(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a474d146"],{"06fa":function(e,t,n){"use strict";var r=n("9825"),i=n.n(r);i.a},1338:function(e,t,n){},"177b":function(e,t,n){"use strict";var r=n("ba0e"),i=n.n(r);i.a},"1e91":function(e,t,n){},5424:function(e,t,n){"use strict";var r=n("1e91"),i=n.n(r);i.a},"5ed7":function(e,t,n){"use strict";var r=n("1338"),i=n.n(r);i.a},"7a7d":function(e,t,n){},9825:function(e,t,n){},ba0e:function(e,t,n){},e0df:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Row",[n("Col",{attrs:{span:"24"}},[n("Tabs",{attrs:{animated:!1}},[n("TabPane",{attrs:{label:"设置"}},[n("basic")],1),n("TabPane",{attrs:{label:"指纹录入"}},[e.fingerType?n("finger",{on:{add:e.addhandle}}):n("fingerEntry",{on:{save:e.savehandle}})],1),n("TabPane",{attrs:{label:"疫苗区域划分"}},[n("region")],1)],1)],1)],1)},i=[],a=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),s=n("2f62"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"basic"},[n("Form",{ref:"frmEdit",attrs:{model:e.formBasic,rules:e.ruleValidate}},[n("Row",{staticClass:"bs-row",attrs:{type:"flex",gutter:8,align:"middle"}},[n("Col",{attrs:{span:"4",justify:"end"}},[n("p",{staticClass:"bs-title"},[e._v("\n                所在区域\n            ")])]),n("Col",{attrs:{span:"6",push:"1"}},[n("FormItem",{attrs:{prop:"address.provinceCode"}},[n("Select",{attrs:{"label-in-value":!0},on:{"on-change":e.changeProvince},model:{value:e.formBasic.address.provinceCode,callback:function(t){e.$set(e.formBasic.address,"provinceCode",t)},expression:"formBasic.address.provinceCode"}},e._l(e.provinces,(function(t){return n("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1)],1),n("Col",{attrs:{span:"6",push:"1"}},[n("FormItem",{attrs:{prop:"address.cityCode"}},[n("Select",{attrs:{"label-in-value":!0},on:{"on-change":e.changeCity},model:{value:e.formBasic.address.cityCode,callback:function(t){e.$set(e.formBasic.address,"cityCode",t)},expression:"formBasic.address.cityCode"}},e._l(e.citys,(function(t){return n("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1)],1),n("Col",{attrs:{span:"6",push:"1"}},[n("FormItem",{attrs:{prop:"address.countyCode"}},[n("Select",{attrs:{"label-in-value":!0},on:{"on-change":e.changeCounty},model:{value:e.formBasic.address.countyCode,callback:function(t){e.$set(e.formBasic.address,"countyCode",t)},expression:"formBasic.address.countyCode"}},e._l(e.countys,(function(t){return n("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1)],1)],1),n("Row",{staticClass:"bs-row",attrs:{align:"middle",type:"flex"}},[n("Col",{attrs:{span:"4",justify:"end"}},[n("p",{staticClass:"bs-title"},[e._v("\n                所在接种台\n            ")])]),n("Col",{attrs:{span:"18",push:"1"}},[n("FormItem",{attrs:{prop:"cabinetNo"}},[n("Select",{attrs:{"label-in-value":!0},model:{value:e.formBasic.cabinetNo,callback:function(t){e.$set(e.formBasic,"cabinetNo",t)},expression:"formBasic.cabinetNo"}},e._l(e.cabinetNos,(function(t){return n("Option",{attrs:{value:t.value}},[e._v(e._s(t.value))])})),1)],1)],1)],1),n("Row",{staticClass:"bs-row",attrs:{align:"middle",type:"flex"}},[n("Col",{attrs:{span:"4",justify:"end"}},[n("p",{staticClass:"bs-title"},[e._v("\n                所在单位\n            ")])]),n("Col",{attrs:{span:"18",push:"1"}},[n("FormItem",{attrs:{prop:"unitCode"}},[n("Select",{attrs:{"label-in-value":!0},on:{"on-change":e.changeUnit},model:{value:e.formBasic.unitCode,callback:function(t){e.$set(e.formBasic,"unitCode",t)},expression:"formBasic.unitCode"}},e._l(e.units,(function(t){return n("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1)],1)],1),n("Row",{staticClass:"bs-row",attrs:{align:"middle",type:"flex"}},[n("Col",{attrs:{span:"4",justify:"end"}},[n("p",{staticClass:"bs-title"},[e._v("\n                设备编号\n            ")])]),n("Col",{attrs:{span:"18",push:"1"}},[n("FormItem",{attrs:{prop:"alias"}},[n("Input",{attrs:{size:"large",placeholder:"设备编号"},model:{value:e.formBasic.alias,callback:function(t){e.$set(e.formBasic,"alias",t)},expression:"formBasic.alias"}})],1)],1)],1),n("Row",{attrs:{type:"flex",justify:"center"}},[n("p",{staticClass:"bs-info"},[e._v("更改基本信息后请点击保存按钮")])]),n("Row",{staticClass:"bs-submit",attrs:{type:"flex",justify:"center"}},[n("Button",{attrs:{type:"primary"},on:{click:function(t){return e.save("frmEdit")}}},[e._v("保存")])],1)],1)],1)},o=[],u=(n("7f7f"),n("96cf"),n("3b8d"));function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={data:function(){return{provinces:[],citys:[],countys:[],cabinetNos:[],units:[],formBasic:{alias:"",address:{provinceCode:"",provinceName:"",cityCode:"",cityName:"",countyCode:"",countyName:""},cabinetNo:"",unitCode:"",unitName:""},ruleValidate:{alias:[{required:!0,message:"请输入设备编号",trigger:"blur"}],cabinetNo:[{required:!0,type:"string",message:"请选择接种台编号",trigger:"change"}],unitCode:[{required:!0,type:"string",message:"请选择所在单位",trigger:"change"}],"address.provinceCode":[{required:!0,type:"string",message:"请选择省份",trigger:"change"}],"address.cityCode":[{required:!0,type:"string",message:"请选择市",trigger:"change"}],"address.countyCode":[{required:!0,type:"string",message:"请选择区(县)",trigger:"change"}]}}},computed:l({},Object(s["c"])({device:"device"})),methods:{init:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.device.address&&(this.formBasic.alias=this.device.alias,this.formBasic.cabinetNo=this.device.cabinetNo,this.formBasic.unitCode=this.device.unitCode,this.formBasic.unitName=this.device.unitName,this.formBasic.address.provinceCode=this.device.address.provinceCode,this.formBasic.address.cityCode=this.device.address.cityCode,this.formBasic.address.countyCode=this.device.address.countyCode,this.formBasic.address.provinceName=this.device.address.provinceName,this.formBasic.address.cityName=this.device.address.cityName,this.formBasic.address.countyName=this.device.address.countyName),e.next=3,this.queryDistrict();case 3:return e.next=5,this.queryCabinetNo();case 5:return e.next=7,this.queryUnit();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),queryUnit:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/zcy/queryUnit");case 2:t=e.sent,this.units=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),queryDistrict:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/zcy/queryDistrict");case 2:t=e.sent,t=t.data,this.provinces.push({name:t.name,code:t.code}),this.citys=t.child,this.countys=t.child[0].child;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),queryCabinetNo:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/zcy/queryCabinetNo");case 2:t=e.sent,this.cabinetNos=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),changeProvince:function(e){this.formBasic.address.provinceName=e.label},changeCity:function(e){this.formBasic.address.cityName=e.label},changeCounty:function(e){this.formBasic.address.countyName=e.label},changeUnit:function(e){this.formBasic.unitName=e.label},save:function(e){var t=this;this.$refs[e].validate((function(e){e&&t.$api.post("/device/modifyDevice",l({id:t.device._id},t.formBasic)).then((function(e){t.$Message.success("修改设备归属成功!")}))}))}},mounted:function(){this.init()}},p=f,v=(n("06fa"),n("2877")),m=Object(v["a"])(p,c,o,!1,null,null,null),h=m.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fingerprint card"},[2==e.fingerCount?n("div",{staticClass:"fingerprint-info"},[e._v("指纹信息已采集")]):e._e(),e.fingerCount<2?n("div",{staticClass:"fingerprint-add",on:{click:function(t){return e.addFinger()}}},[e._v("新增")]):e._e(),n("div",{staticClass:"fingerprint-clear",on:{click:function(t){e.modal1=!0}}},[e._v("清除")]),n("Modal",{attrs:{title:"消息提示"},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[n("p",[e._v("是否确认删除所有指纹")])])],1)},b=[];function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={data:function(){return{modal1:!1,fingerCount:0}},computed:O({},Object(s["c"])({user:"user",device:"device"})),watch:{},methods:O({},Object(s["b"])({saveUser:"saveUser"}),{ok:function(){this.delAll()},cancel:function(){this.modal1=!1},addFinger:function(){this.$emit("add",!1)},delAll:function(){var e=this;console.log("删除指纹前获取的user信息 result:"+JSON.stringify(this.user)),this.$device.fingerDelAll({userId:this.user._id}).then((function(t){0==JSON.parse(t.rsp).code&&(console.log("这里已经监听到删除的动作了"),e.deleteFinger({id:e.user._id,finger:[]}))}))},deleteFinger:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.post("/user/modifyUserById",t);case 2:n=e.sent,console.log("这里已经监听到更新指纹的动作了 result:"+JSON.stringify(n)),1==n.data.ok&&(this.user.finger=[],this.fingerCount=this.user.finger.length);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}),mounted:function(){this.fingerCount=this.user.finger.length}},w=C,_=(n("177b"),Object(v["a"])(w,g,b,!1,null,null,null)),j=_.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e._m(0),n("div",{staticClass:"mainBottom"},[e._m(1),n("div",{staticClass:"mainBottomRight"},[n("div",{staticClass:"index"},e._l(e.row,(function(t,r){return n("p",{staticClass:"indexBlock"},[n("span",{staticClass:"indexSpan"},[e._v("第"+e._s(r+1)+"行")])])})),0),n("div",{staticClass:"cabines"},e._l(e.cabineData,(function(t,r){return n("div",{staticClass:"cabine"},[n("div",{staticClass:"vaccineBox"},[e._l(t.vaccine,(function(t,i){return n("div",{staticClass:"vaccineBox-list"},[n("div",{staticClass:"vaccineBox-list-title"},[e._v(e._s(t.name))]),n("div",{staticClass:"vaccineBox-list-del",on:{click:function(t){return e.delVaccine(r,i)}}},[n("img",{attrs:{src:"/static/img/del.png"}})])])})),t.vaccine.length<4?n("Select",{staticClass:"chooseVaccine",attrs:{"label-in-value":!0},on:{"on-change":function(t){return e.select(r,t)}}},e._l(e.kindList,(function(t){return n("Option",{key:t.code,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1):e._e(),t.vaccine.length<4?n("img",{staticClass:"boxAdd",attrs:{src:"/static/img/add.png"},on:{click:function(t){return e.addVaccine(r)}}}):e._e()],2)])})),0)])])])},x=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mainTop"},[n("p",{staticClass:"ctOne"},[e._v("抽屉1")]),n("p",{staticClass:"ctLeft"},[e._v("左")]),n("img",{staticClass:"l_r",attrs:{src:"/static/img/l-r.png"}}),n("p",{staticClass:"ctRight"},[e._v("右")]),n("p",{staticClass:"ctTwo"},[e._v("抽屉2")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mainBottomLeft"},[n("p",{staticClass:"ctTop"},[e._v("上")]),n("img",{staticClass:"t_b",attrs:{src:"/static/img/t-b.png"}}),n("p",{staticClass:"ctBottom"},[e._v("下")])])}];function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(n,!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P={data:function(){return{row:0,cabineData:[],kindList:[],vaccineOneName:"",vaccineTwoName:""}},computed:k({},Object(s["c"])({device:"device"})),methods:{addVaccine:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.cabineData[t],""!=n.name&&""!=n.code){e.next=3;break}return e.abrupt("return",!1);case 3:if(""===this.cabineData[t].vaccine||void 0===this.cabineData[t].vaccine){e.next=13;break}r=this.cabineData[t].vaccine,i=0;case 6:if(!(i<r.length)){e.next=13;break}if(r[i].code!=this.cabineData[t].code){e.next=10;break}return this.$Message.error({content:"同一个抽屉不允许设置相同的疫苗",duration:10,closable:!0}),e.abrupt("return",!1);case 10:i++,e.next=6;break;case 13:return e.next=15,this.$api.post("/drawer/modifyDrawerById",{id:n._id,vaccine:{device:this.device._id,code:n.code,name:n.name}});case 15:this.queryDrawerByCondition();case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),delVaccine:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=this.cabineData[t],!(r.vaccine[n].surplus>0)){e.next=4;break}return this.$Message.info({top:300,content:"该疫苗数量大于0，不允许删除",duration:10,closable:!0}),e.abrupt("return",!1);case 4:return e.next=6,this.$api.post("/drawer/modifyDrawerByIdDec",{id:r._id,vaccineId:r.vaccine[n]._id});case 6:e.sent,this.queryDrawerByCondition();case 8:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),select:function(e,t){this.cabineData[e].name=t.label,this.cabineData[e].code=t.value},queryVaccineKinds:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/zcy/queryVaccineKinds");case 2:t=e.sent,this.kindList=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),queryDrawerByCondition:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.cabineData=[],e.next=3,this.$api.get("/drawer/queryDrawerByCondition",{device:this.device._id});case 3:for(t=e.sent,n=t.data,r=0;r<n.length;r++)this.$set(n[r],"code",""),this.$set(n[r],"name","");this.cabineData=n,this.row=this.cabineData.length/2;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){this.queryVaccineKinds(),this.queryDrawerByCondition(),console.log(this.cabineData)}},N=P,$=(n("5424"),Object(v["a"])(N,B,x,!1,null,"44f75d07",null)),R=$.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fingerAdd"},[e._m(0),n("div",{staticClass:"fingerAdd-footer"},[e.noticeState?e._e():n("div",{staticClass:"fingerAdd-notice"},[e._v(e._s(e.notice))]),e.noticeState?n("div",{staticClass:"fingerAdd-succeed"},[n("img",{attrs:{src:"/static/img/succeed.png",alt:""}}),n("div",[e._v("指纹录入成功，请保存")])]):e._e()])])},E=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fingerAdd-conent"},[n("div",{staticClass:"fingerAdd-title"},[e._v("放置手指")]),n("div",{staticClass:"fingerAdd-info"},[e._v("将手指放置在指纹仪上，识别完成后移开，并重复此步骤")]),n("img",{attrs:{src:"/static/img/fingerEntry.png",alt:""}})])}];function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(n,!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T={data:function(){return{noticeState:!1,notice:""}},computed:I({},Object(s["c"])({user:"user"})),methods:I({},Object(s["b"])({saveUser:"saveUser",saveDevice:"saveDevice"}),{register:function(){this.$device.fingerRegister({userId:this.user._id})},modifyUserById:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.post("/user/modifyUserById",t);case 2:e.sent;case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}),mounted:function(){var e=this;this.$device.subscribe("FINGER_MESSAGE",(function(t){if(e.notice=t.msg,2==t.type){e.noticeState=!0;var n=e.user.finger;if(n.push("2"),e.modifyUserById({id:e.user._id,finger:n}),n.length<2)e.register();else var r=setTimeout((function(){e.$emit("save",!0),clearTimeout(r)}),1500)}else e.noticeState=!1})),this.register()}},U=T,A=(n("f48e"),Object(v["a"])(U,S,E,!1,null,"42e2b4d4",null)),F=A.exports;function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(n,!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J={components:{basic:h,finger:j,region:R,fingerEntry:F},data:function(){return{fingerType:!0}},computed:z({},Object(s["c"])({user:"user",device:"device"})),methods:{addhandle:function(e){this.fingerType=e},savehandle:function(e){this.fingerType=e}},mounted:function(){}},L=J,M=(n("5ed7"),Object(v["a"])(L,r,i,!1,null,null,null));t["default"]=M.exports},f48e:function(e,t,n){"use strict";var r=n("7a7d"),i=n.n(r);i.a}}]);