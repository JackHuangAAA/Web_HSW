(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49133fd6"],{2366:function(e,t){for(var n=[],a=0;a<256;++a)n[a]=(a+256).toString(16).substr(1);function i(e,t){var a=t||0,i=n;return[i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]]].join("")}e.exports=i},a8a7:function(e,t,n){},c437:function(e,t,n){var a,i,c=n("e1f4"),r=n("2366"),s=0,o=0;function u(e,t,n){var u=t&&n||0,v=t||[];e=e||{};var d=e.node||a,h=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==h){var p=c();null==d&&(d=a=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==h&&(h=i=16383&(p[6]<<8|p[7]))}var l=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:o+1,m=l-s+(f-o)/1e4;if(m<0&&void 0===e.clockseq&&(h=h+1&16383),(m<0||l>s)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=l,o=f,i=h,l+=122192928e5;var y=(1e4*(268435455&l)+f)%4294967296;v[u++]=y>>>24&255,v[u++]=y>>>16&255,v[u++]=y>>>8&255,v[u++]=255&y;var w=l/4294967296*1e4&268435455;v[u++]=w>>>8&255,v[u++]=255&w,v[u++]=w>>>24&15|16,v[u++]=w>>>16&255,v[u++]=h>>>8|128,v[u++]=255&h;for(var g=0;g<6;++g)v[u+g]=d[g];return t||r(v)}e.exports=u},de42:function(e,t,n){"use strict";var a=n("a8a7"),i=n.n(a);i.a},e1f4:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var a=new Uint8Array(16);e.exports=function(){return n(a),a}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},ffd3:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"container"},[a("div",{staticClass:"containerBody"},[a("div",{staticClass:"title"},[a("div",{staticClass:"titleLeft",on:{click:t.matchInfo}},[t._v("\n            接种人信息\n        ")]),a("div",{staticClass:"titleRight"},[t._v("\n            疫苗信息\n        ")])]),a("div",{staticClass:"content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"leftTop"},[a("div",{staticClass:"leftTopLeft"},[a("span",{staticClass:"code"},[t._v(t._s(t.vaccinationData?t.vaccinationData.code:"")+"号")]),a("span",{staticClass:"name"},[t._v(t._s(t.vaccinationData?t.vaccinationData.name:""))])]),a("div",{staticClass:"leftTopRight"},[a("div",{staticClass:"age"},[t._v("\n                        年龄:\n                    ")]),a("div",{staticClass:"ageCount"},[t._v("\n                        "+t._s(t.vaccinationData?t.vaccinationData.age:"")+"周岁\n                    ")])]),a("div",{staticClass:"leftTopRightTwo"},[a("div",{staticClass:"age"},[t._v("\n                        性别:\n                    ")]),a("div",{staticClass:"ageCount"},[t._v("\n                        "+t._s(t.vaccinationData?t.vaccinationData.sex:"")+"\n                    ")])])]),t.vaccinationData?a("div",{staticClass:"leftBottom"},[a("div",{staticClass:"personInf"},[a("div",[t.status?a("div",[t.ready?t._e():a("span",{staticClass:"tipInf",staticStyle:{color:"#F42954"}},[t._v("信息不匹配")]),t.status?t._e():a("img",{staticClass:"succeed",attrs:{src:"/static/img/error.png"}}),t.ready?a("span",{staticClass:"tipInf",staticStyle:{color:"#1AA95E"}},[t._v(t._s(t.confirm?"已接种":"信息匹配"))]):t._e(),t.status?a("img",{staticClass:"succeed",attrs:{src:"/static/img/succeed.png"}}):t._e()]):t._e(),a("Checkbox",{staticClass:"personInf-check",model:{value:t.single,callback:function(e){t.single=e},expression:"single"}},[t._v(t._s(t.vaccineName))])],1),a("div",{staticClass:"producter"},[t._v("\n                        生产厂家："+t._s(t.vaccineProduct)+"\n                    ")]),a("div",{staticClass:"vaccine-info"},[a("div",{staticClass:"vaccine-info-part"},[a("div",[t._v("接种部位：")]),a("Select",{staticStyle:{width:"9rem",height:"2.25rem"},model:{value:t.partVal,callback:function(e){t.partVal=e},expression:"partVal"}},t._l(t.part,(function(e){return a("Option",{key:e.key,attrs:{value:e.value}},[t._v(t._s(e.value))])})),1)],1),a("div",{staticClass:"vaccine-info-num"},[t._v("\n                            接种剂量：1支\n                        ")])]),a("div",{staticClass:"vaccine-btnBox"},[t.single&&t.status&&t.ready?a("button",{attrs:{disabled:t.confirm},on:{click:function(e){return t.confirmVaccine()}}},[t._v("确认接种")]):t._e()])])]):t._e()]),a("div",{staticClass:"right"},[t.showScan?a("div",{staticClass:"vaccineInf"},[a("div",{staticClass:"vaccineInf-top"},[a("div",[a("span",[t._v(t._s(t.vaccine.name))])]),a("div",[t._v("监管码："),a("span",[t._v(t._s(t.vaccine.supervisionCode))])]),t._m(0),t._m(1)]),a("div",{staticClass:"vaccineInf-bottom"},[t._v("有效期："),a("span",[t._v("2019-09-18 12:30:28   至  "+t._s(t.vaccine.expiry))])]),a("div",{staticClass:"vaccineInf-bottom"},[t._v("生产厂家："),a("span",[t._v(t._s(t.vaccine.product))])]),t._m(2)]):t._e()])]),a("div",{staticClass:"bottom-btn"},[a("button",{on:{click:function(){e.$emit("changeMenu",0),e.$router.push("/main")}}},[t._v("返回主页")]),a("button",{on:{click:function(e){return t.queryNextQueue()}}},[t._v("下一位")])])])])},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mt24"},[e._v("批次号："),n("span",[e._v("Y750230-64368")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mt24"},[e._v("疫苗剂量："),n("span",[e._v("0.5ml/支")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vaccineInf-bottom"},[e._v("接种份数："),n("span",[e._v("1")])])}],c=(n("8e6e"),n("ac6a"),n("456d"),n("7f7f"),n("96cf"),n("3b8d")),r=n("bd86"),s=n("2f62"),o=n("c1df"),u=n.n(o),v=n("c437"),d=n.n(v);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(n,!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={data:function(){return{progress:0,batchId:d()(),commonData:null,audio:null,confirmAudio:null,wrongAudio:null,queryVaccine:null,vaccinationData:{},vaccine:[],part:[{value:"左上臂",key:"左上臂"},{value:"右上臂",key:"右上臂"}],partVal:"",single:!0,status:!1,vaccineName:"",confirm:!1,ready:!1,showScan:!1,drawer:{},vaccineProduct:""}},computed:p({},Object(s["c"])({user:"user",device:"device"})),methods:{matchInfo:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$device.subscribe("SCANNER_RESULT",function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("/vaccination/vaccination"==t.$route.path){e.next=2;break}return e.abrupt("return",!1);case 2:return console.log("这里是扫码枪的内容 result:"+JSON.stringify(n)),e.next=5,t.getVaccine(n.data);case 5:a=u()().isBefore(t.vaccine.expiry),console.log("这里是日期比较结果："+JSON.stringify(a)),t.status=!0,t.showScan=!0,t.vaccine.name==t.vaccineName&&a?(t.progress=1,t.ready=!0,t.confirmAudio.play()):(t.progress=2,t.ready=!1,t.wrongAudio.play());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),confirmVaccine:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.modifyQueue({id:this.vaccinationData._id,status:0,finishDate:new Date}).then((function(e){console.log("这里是queue信息修改完成后的结果"+JSON.stringify(e))}));case 2:this.confirm=!0,this.modifyVaccineNum({id:this.queryVaccine._id,total:0,surplus:-1}),console.log("这里是drawer的信息:"+JSON.stringify(this.drawer)),this.saveInout(p({batchId:this.batchId},this.commonData,{x:this.drawer.x,y:this.drawer.y,code:this.drawer.vaccine.code,name:this.drawer.vaccine.name,total:this.drawer.vaccine.total,surplus:this.drawer.vaccine.surplus})),this.saveVaccination({user:this.user._id,device:this.device._id,deviceType:this.device.type,unitCode:this.device.unitCode,unitName:this.device.unitName,sort:"",customer:{code:this.vaccinationData.code,name:this.vaccinationData.name,age:this.vaccinationData.age,sex:this.vaccinationData.sex,vaccineCode:this.vaccinationData.vaccine.code,vaccineName:this.vaccinationData.vaccine.name,vaccineNum:this.vaccinationData.vaccine.count},match:{vaccineCode:this.vaccinationData.vaccine.code,vaccineName:this.vaccinationData.vaccine.name,supervisionCode:this.vaccine.supervisionCode,expiry:this.vaccine.expiry,product:this.vaccine.product}});case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getExpiryDate:function(e){return u()(e).format("YYYY-MM-DD HH:mm:ss")},getVaccine:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/zcy/queryVaccine",{code:t}).then((function(e){n.vaccine=e.data}));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),modifyVaccineNum:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.post("/vaccine/modifyVaccineNum",t);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),saveInout:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.post("/inout/saveInout",t);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),saveVaccination:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.post("/vaccination/saveVaccination",t);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),queryVaccineByCondition:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/vaccine/queryVaccineByCondition",t);case 2:n=e.sent,this.queryVaccine=n.data[0];case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),queryDrawerByCondition:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/drawer/queryDrawerByCondition",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),modifyQueue:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.post("/queue/modifyQueue",t);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),openDrawer:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.queryVaccineByCondition({device:this.device._id,sortSurplus:!0,surplusIsNotZero:!0,code:t.vaccine.code});case 2:return e.next=4,this.queryDrawerByCondition({device:this.device._id,vaccineCode:this.queryVaccine._id});case 4:for(n=e.sent,this.drawer=n.data[0],a={},i=0;i<this.drawer.vaccine.length;i++)this.vaccineName==this.drawer.vaccine[i].name&&(a=this.drawer.vaccine[i]);this.drawer.vaccine=a,console.log("drawer===>"+JSON.stringify(this.drawer)),this.$device.openDrawer({num:this.drawer.x+"#"+this.drawer.y}),this.audio.play();case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),queryQueue:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.get("/queue/queryQueueByCondition",{status:1}).then((function(e){t.vaccinationData=e.data[0],console.log(t.vaccinationData),t.vaccineName=e.data[0].vaccine.name,t.vaccineProduct=e.data[0].vaccine.product}));case 2:this.openDrawer(this.vaccinationData);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),queryNextQueue:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.confirm){e.next=4;break}this.confirm=!1,e.next=6;break;case 4:return e.next=6,this.modifyQueue({id:this.vaccinationData._id,status:0,finishDate:new Date}).then((function(e){console.log("这里是queue信息修改完成后的结果"+JSON.stringify(e))}));case 6:return this.ready=!1,this.status=!1,this.showScan=!1,e.next=11,this.$api.get("/queue/queryQueueByCondition",{status:1,next:1}).then((function(e){t.vaccinationData=e.data[0],console.log(t.vaccinationData),t.vaccineName=e.data[0].vaccine.name,t.vaccineProduct=e.data[0].vaccine.product}));case 11:this.openDrawer(this.vaccinationData);case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){this.commonData={type:0,user:this.user._id,device:this.device._id,deviceType:1,unitCode:this.device.unitCode,unitName:this.device.unitName},this.audio=new Audio,this.audio.src="/static/audio/outVaccine.mp3",this.confirmAudio=new Audio,this.confirmAudio.src="/static/audio/vaccineCheckConfirm.mp3",this.wrongAudio=new Audio,this.wrongAudio.src="/static/audio/vaccineCheckWrong.mp3",this.queryQueue(),this.matchInfo()}},f=l,m=(n("de42"),n("2877")),y=Object(m["a"])(f,a,i,!1,null,"7321a8f8",null);t["default"]=y.exports}}]);